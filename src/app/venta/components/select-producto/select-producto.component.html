<!-- select-producto.component.html -->

<div class="modal-header">
  <h4 class="modal-title">Seleccionar producto</h4>
  <button type="button" class="btn-close" aria-label="Close" (click)="modalRef.hide()"></button>
</div>

<div class="modal-body">

  <!-- Formulario de búsqueda -->
  <form [formGroup]="formSearch" (ngSubmit)="search()">
    <div class="input-group mb-3">
      <input type="text" formControlName="fieldCodigo" class="form-control w-25" placeholder="Codigo">
      <input type="text" formControlName="fieldNombre" class="form-control w-50" placeholder="Buscar ...">
      <button class="btn btn-outline-secondary" [disabled]="submitted" type="submit">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </form>

  <!-- Tabla de productos -->
  <div class="table-responsive">
    <table class="table table-hover">
      <thead>
        <tr>
          <th>ID</th>
          <th>Codigo</th>
          <th>Nombre</th>
          <th>Marca</th>
          <th>Area</th>
          <th>Precio</th>
          <th>Detalle</th>
          <th>Stock</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of almacenes"
            [class.table-danger]="item.producto?.deleted_at"
            (click)="select(item)"
            style="cursor: pointer;">
          <td>{{item.id}}</td>
          <td>{{item.producto?.id}}</td>
          <td>{{item.producto?.nombre}}</td>
          <td>{{item.producto?.marca}}</td>
          <td>{{item.producto?.area}}</td>
          <td>{{item.producto?.precio}}</td>
          <td>{{item.producto?.detalle}}</td>
          <td>{{item.cantidad}}</td>
        </tr>
        <tr *ngIf="almacenes.length == 0">
          <td colspan="8" class="text-center">No hay registros</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Paginación -->
  <div class="d-flex justify-content-between align-items-center p-2">
    <select class="form-select" style="width: auto" [(ngModel)]="pagination.pageSize" (ngModelChange)="search()">
      <option *ngFor="let size of pagination.sizeOptions" [ngValue]="size">{{size}} por pagina</option>
    </select>

    <small class="p-3">{{pagination.totalCount}} resultados</small>

    <pagination
      [totalItems]="pagination!.totalCount"
      [(ngModel)]="pagination.page"
      [itemsPerPage]="pagination.pageSize"
      [maxSize]="3"         
      [boundaryLinks]="false"  
      [rotate]="true"         
      (pageChanged)="pageChanged($event)">
    </pagination>
  </div>

</div>

<div class="modal-footer">
  <button type="button" class="btn btn-outline-secondary" (click)="modalRef.hide()">
    <i class="bi bi-x"></i> Cerrar
  </button>
</div>
